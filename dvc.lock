schema: '2.0'
stages:
  ingest:
    cmd: python src/ingest_api.py data/raw/data.csv
    deps:
    - path: src/ingest_api.py
      hash: md5
      md5: c53ef9c511709faefc0c9a79d5393404
      size: 1966
    params:
      params.yaml:
        ingest.api_url: http://127.0.0.1:5000/generate_synthetic_data
    outs:
    - path: data/raw
      hash: md5
      md5: 585633cf965ad40b1df7f97da169dbe7.dir
      size: 142039
      nfiles: 1
  ingest_static:
    cmd: python src/ingest_static.py data/raw/static/static_data.csv
    deps:
    - path: src/ingest_static.py
      hash: md5
      md5: 6f429925b269a614be2e42411b9455c2
      size: 1230
    params:
      params.yaml:
        ingest.csv_url: 
          https://raw.githubusercontent.com/dsrscientist/DSData/master/Telecom_customer_churn.csv
    outs:
    - path: data/raw/static
      hash: md5
      md5: d3c0c20c848c3e4291690abe1ab818ee.dir
      size: 977501
      nfiles: 1
  ingest_api:
    cmd: python src/ingest_api.py data/raw/api/api_data.csv
    deps:
    - path: src/ingest_api.py
      hash: md5
      md5: 9c02b12a1a5cca45b67aa39543b20c1a
      size: 1914
    params:
      params.yaml:
        ingest.api_url: http://127.0.0.1:5000/generate_synthetic_data
    outs:
    - path: data/raw/api
      hash: md5
      md5: b95110f8852d66a67cde220a9ba4027b.dir
      size: 142246
      nfiles: 1
  validate:
    cmd: python src/validate.py data/raw/api/api_data.csv data/raw/static/static_data.csv
      data/report/validation_report.json
    deps:
    - path: data/raw/api
      hash: md5
      md5: b95110f8852d66a67cde220a9ba4027b.dir
      size: 142246
      nfiles: 1
    - path: data/raw/static
      hash: md5
      md5: d3c0c20c848c3e4291690abe1ab818ee.dir
      size: 977501
      nfiles: 1
    - path: src/validate.py
      hash: md5
      md5: 4ac1b34731b51b1bff46806432a0c6b0
      size: 2253
    outs:
    - path: data/report
      hash: md5
      md5: af4dbe0a4d2f2f30a5ce4f59f0b9942a.dir
      size: 5875
      nfiles: 1
  prepare:
    cmd: python src/prepare.py data/raw/api/api_data.csv data/raw/static/static_data.csv
    deps:
    - path: data/report
      hash: md5
      md5: af4dbe0a4d2f2f30a5ce4f59f0b9942a.dir
      size: 5875
      nfiles: 1
    - path: src/prepare.py
      hash: md5
      md5: 64dfd2bb461406f8393a809dd9d6ffbe
      size: 5396
    outs:
    - path: logs/prepare_file.log
      hash: md5
      md5: feb079dca8db98a1dc538624576c7edb
      size: 2870
  store:
    cmd: python src/store.py data/processed/api/api_data.csv data/processed/static/static_data.csv
    deps:
    - path: logs/prepare_file.log
      hash: md5
      md5: feb079dca8db98a1dc538624576c7edb
      size: 2870
    - path: src/store.py
      hash: md5
      md5: b996dee5fb4b1bea6561f2fb78573247
      size: 3368
    outs:
    - path: logs/store_sql.log
      hash: md5
      md5: 6bd1a09e0d1174f65faa4bb451a73769
      size: 620
  feature_store:
    cmd: python src/feature_store.py
    deps:
    - path: logs/store_sql.log
      hash: md5
      md5: 6bd1a09e0d1174f65faa4bb451a73769
      size: 620
    - path: src/feature_store.py
      hash: md5
      md5: 062fd4070a6e7ed5b52a100436970154
      size: 1651
    outs:
    - path: logs/feature_store.log
      hash: md5
      md5: 577565656217450d1b860519e0f0be18
      size: 30548
  train:
    cmd: python src/train.py
    deps:
    - path: logs/feature_store.log
      hash: md5
      md5: 577565656217450d1b860519e0f0be18
      size: 30548
    - path: src/train.py
      hash: md5
      md5: 8ba8e90d786fc1c55fd71785d5a971fd
      size: 1912
    outs:
    - path: model/model.pkl
      hash: md5
      md5: 20868e3d06d9d82181618fd6da4d5c85
      size: 55084634
